---
format: html
editor: visual
---

```{r, eval = F}
# This code chunk contains code to install all of the dependencies
# necessary to compile and run your report, using if-statements to
# reduce install time for unnecessary code.
# It should be set to eval = F by default, so you aren't installing
# software on someone's computer without their consent.

# This works for packages that are on CRAN
if (!"dplyr" %in% installed.packages()) {
  install.packages("dplyr")
}
if (!"remotes" %in% installed.packages()) {
  install.packages("remotes")
}

# This is how to do it for a package that's only on github
if (!"emo" %in% installed.packages()) {
  remotes::install_github("hadley/emo")
}  

```

```{r}
BabyNames <- read.csv("Popular_Baby_Names.csv")
#colnames(BabyNames)
#str(BabyNames)
sum(is.na(BabyNames)) # check missing values; no missing values

library(dplyr)
# distinct this dataset; remove the repeated rows based on X element 
BabyNames$Child.s.First.Name <- tolower(BabyNames$Child.s.First.Name)

# Using unique function to get 
babynames<- unique(BabyNames) # remove the repeated rows; 

# combine the ethnic groups b/c they have the same meaning
modified_data <- babynames %>% mutate(Ethnicity = recode(Ethnicity, "BLACK NON HISP" = "BLACK NON HISPANIC" ,
                                                      "ASIAN AND PACI" = "ASIAN AND PACIFIC ISLANDER",
                                                      "WHITE NON HISP" = "WHITE NON HISPANIC" )) 

# check the result; there are total 4 levels in the ethnic groups
#M_data1 <- modified_data %>% group_by(Ethnicity) %>% count()
#M_data2 <- modified_data %>% group_by(Ethnicity, Gender) %>% count()
```

```{r, echo=FALSE, message=FALSE}
library(tidyverse)
library(reshape2)
library(phonics)

#install.packages("wordcloud")
library(wordcloud)
#install.packages("RColorBrewer")
library(RColorBrewer)
#install.packages("wordcloud2")
#library(wordcloud2)
#install.packages("tm")
#library(tm)
#install.packages("ggwordcloud")
library(ggwordcloud)
```

## Introduction

### Description of the Data set

This dataset, `BabyNames`, consist of the popular baby names by sex and ethnic group from 2011 to 2019. It was collected through civil birth registration system. Each row represents a popular baby first name. The dataset includes 6 columns, each indicating a different feature of each first name: 1. `Year of Birth`: a quantitative variable indicating the baby's year of birth, ranging from 2011 to 2019. 2. `Gender`: a categorical variable with two categories-Male and Female. 3. `Ethnicity`: a categorical indicating the mother's ethnicity 4. `Child.s.First.Name`: a categorical variable representing the baby's first name; 5. `Count`: a quantitative variable representing the frequency with which names were collected through civil birth registration. 6. `Rank`: a categorical variable representing the frequency of baby names in descending order for each year.

### Cleaning the Data

In the data cleaning phase, we imported the dataset and discovered that it does not contain any missing values. Additionally, we identified and removed duplicate rows from the initial dataset. There are some ethic groups have the similar names such as `ASIAN AND PACIFIC ISLANDER` and `ASIAN AND PACI`, `BLACK NON HISPANIC` and `BLACK NON HISP` and `WHITE NON HISPANIC` and `WHITE NON HISP`. They are the same ethic groups but with different names, we combine them before we perform analysis regarding our interest, and finally we will use the `modified_data` to do further data analysis. `Black non-Hispanic(BNH)` refers to a person having origins in any of the black racial groups of Africa (except those of Hispanic origin); `White non-Hispanic(WNH)` means a person having origins in any of the original peoples of Europe, the Middle East, or North Africa but not in Hispanic. `Hispanic(H)` refers to a person of Cuban, Mexican, Puerto Rican, South or Central American, or other Spanish culture or origin, regardless of race.; and `Aisan and Pacific Islander(API)` means a person having origins in any of the original peoples of the Far East, Southeast Asia, or the Indian Subcontinent, including, for example, Cambodia, China, India, Japan, Korea, Malaysia, Pakistan, the Philippine Islands, Thailand, and Vietnam, also includes a person having origins in any of the original peoples of Hawaii, Guam, Samoa, or other Pacific Islands. Finally, in the `modified_data` dataset, there are total 2 quantitative variables, `Year of Birth` and `Count`; 4 categorical variables, `Gender`, `Ethnicity`, `Child.s.First.Name` and `Rank`.

(Source:[Ethnic Information1](https://portal.ct.gov/-/media/DOT/documents/ddbe/RaceandEthnicIdentificationDefinitions2015pdf.pdf) [Ethnic Information2](https://research.schev.edu/info/Glossary/Black-or-African-American-Black-non-Hispanic#:~:text=Term%3A%20Black%20or%20African%20American,except%20those%20of%20Hispanic%20origin) [Ethnic Information23](https://www.census.gov/topics/population/race/about.html))

### Aims

First, we display the top ten most popular first names for each gender and ethnic group using bar charts. These charts are easily readable, with the top 10 popular baby first names displayed on the horizontal axis and the frequency of each name shown on the vertical axis. We present eight charts for various ethnic groups, each chart representing the top 10 baby first names for both males and females across four distinct ethnic groups. While these charts effectively identify the most popular names within each group, comparing common names across all groups simultaneously poses a challenge. To address this, we have created a combined dataset and presented the results in side by side bar graphs. Besides, we use side-by-side bar charts to display the frequency of unisex names.

Our next objective is to analyze the average length of names over time and determine if shorter names have become more popular. We address this question by displaying a time plot showing the average length of first names recorded in our dataset from 2011 to 2019, which illustrates the trend over this period.

Additionally, we examine how names rank over time to identify significant changes in their popularity. This analysis allows us to see if a name suddenly becomes very popular or declines in popularity during certain years. It also helps us understand if the most favored names remain constant over time or if they change for boys, girls, and across different ethnic groups. It also offers insights into how different groups of people choose names and whether these preferences evolve over time.

Finally,explore the sounds or phonetics present in various names. By examining the sounds that compose these popular names, we can uncover the recurring phonetic patterns that contribute to their creation and popularity. By delving into the phonetic makeup of names, we can identify common patterns or distinctive sounds that contribute to the appeal of certain names.(Haven't figured out how to do this exactly)

## Methods

After reading data files, we used `str()` function to display the structure of the data, identifying both categorical and quantitative variables. To check for missing values in raw data, we used the `sum(is.na())` function. Observing some repeated rows, we used the `distinct()` function to extract unique rows from the raw data.

In subsetting the dataset for different genders and ethnic groups, we primarily used `dplyr` functions `group_by`, `filter`, `summarise`, `arrange` and `mutate`[@dplyr-package]. For instance, to generate a dataset of popular baby names for each gender, we first selected males using the `filter` function. Then we applied `group_by` to create the dataset of all males names, followed by `summarize` to count the frequencies of each name's occurrence. To sort the dataset, we used `arrange` function to order the names by frequency and the head function to extract the top 10 popular male baby names. For the top 10 popular females names, we simply changed male to female in the `filter` function. Similarly, to generate datasets for four different ethnic groups, we modified the selection criterion in `filter` function. Moreover, we used two conditions in the `filter` function to generate datasets for each gender within a specific ethnic group.

To investigate common results (unisex names) between datasets of different genders within the same ethnic group, we used the `inner_join()` function to combine these datasets and identify any overlapping names.

Additionally, for analyzing the length of names, we used the `str_count` function[@stringr-package] to calculate the number of letters in each name. We also used `group_by`, `mutate` function[@dplyr-package] to add columns showing this count, calculate number of characters for each name, and total length. Then we applied `mean` function to calculate the average name lenght for each gender from year 2011 to 2019.

For data visualization, we primarily used the `ggplot` function[@ggplot2-package]. To generate a bar graph for the popular male names, we used `geom_bar` layer and used `aes mapping` function to define x and y variables. We then add `themes` and `labs` as layers for displaying the title of the plot and labels for the x and y axes. Finally, we applied `theme_minimal()` to make a minimalist theme with no background annotations.

When creating a line group, we replaced `geom_bar` with `geom_line` and `geom_point`. Thus, the general process for generating plots remained consistent; we only needed to modify the layers to produce different types of visualizations. Additionally, we created a word cloud using the `wordcloud` function [@worldcloud-package] providing a graphical representation of the popular names.

## Topic of Exploration

The first question we address is what the top 10 most popular first names are for each gender and ethnic group, and the results are displayed in Figure 1 and Figure 2.

```{r filter dataset by M and F}
#| echo: false

# select top 10 female's names
vf_data <- modified_data %>% 
  filter(Gender == "FEMALE") %>% 
  group_by(Child.s.First.Name, Gender) %>% 
  summarise(freq = sum (Count),  .groups = "drop") %>% 
  arrange(desc(freq)) %>% head(10)

# select top 10 male's names
vm_data <- modified_data %>% 
  filter(Gender == "MALE") %>% 
  group_by(Child.s.First.Name, Gender) %>%
  summarise(freq = sum(Count), .groups = "drop") %>% 
  arrange(desc(freq)) %>% 
  head(10)
```

```{r}
#| label: fig-genders1
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Bar Graph of the Top 10 First Names for Males and Females"
#| echo: false

library(ggplot2)

vm_data$Child.s.First.Name <-factor(vm_data$Child.s.First.Name, levels = vm_data$Child.s.First.Name) 

ggplot(data=vm_data, aes(x= Child.s.First.Name, y=freq)) +
  geom_bar(stat="identity", fill = 'steelblue2') +
  theme(axis.text.x = element_text(angle =45, hjust = 1)) +
  labs(title = "Top 10 Popular Male Babies' Names", 
       subtitle = "from 2011 to 2019", 
       x = "Child's First Name", 
       y = "Count") + 
    theme_minimal()

vf_data$Child.s.First.Name <-factor(vf_data$Child.s.First.Name, levels = vf_data$Child.s.First.Name) 

ggplot(data=vf_data, aes(x= Child.s.First.Name, y=freq)) +
  geom_bar(stat="identity", fill = 'hotpink') +
  theme(axis.text.x = element_text(angle =45, hjust = 1)) +
  labs(title = "Top 10 Popular Female Babies' Names", 
       subtitle = "from 2011 to 2019", 
       x = "Child's First Name", 
       y = "Count") + 
    theme_minimal()
```

We can see the top 10 names for each gender on horizontal axis from these two bar charts, and the frequency of each name displayed on vertical axis.


In the bar charts presented in Figures 3 to Figure 10, we clearly display the top 10 male and female names for each ethnic group.

```{r filter dataset by ethnic groups}
#| echo: false

# top 10 names in ethnic group of API between Males and Females
em1_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "ASIAN AND PACIFIC ISLANDER" & Gender == "MALE") %>% group_by(Child.s.First.Name) %>% summarise(freqM_API = sum(Count), .groups = "drop") %>% arrange(desc(freqM_API)) %>% head(n=10)

ef1_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "ASIAN AND PACIFIC ISLANDER", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_API = sum(Count)) %>% arrange(desc(freqF_API)) %>% slice_head(n=10)


# top 10 names in ethnic group of BNH between Males and Females
em2_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "BLACK NON HISPANIC", Gender == "MALE") %>% group_by(Child.s.First.Name) %>% summarise(freqM_BNH = sum(Count)) %>% arrange(desc(freqM_BNH)) %>% slice_head(n=10)

ef2_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "BLACK NON HISPANIC", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_BNH = sum(Count)) %>% arrange(desc(freqF_BNH)) %>% slice_head(n=10)

# top 10 names in ethnic group of H between Males and Females
em3_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "HISPANIC", Gender == "MALE") %>% group_by(Child.s.First.Name) %>% summarise(freqM_H = sum(Count)) %>% arrange(desc(freqM_H)) %>% slice_head(n=10)

ef3_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "HISPANIC", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_H = sum(Count)) %>% arrange(desc(freqF_H)) %>% slice_head(n=10)

# top 10 names in ethnic group of WNH between Males and Females
em4_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "WHITE NON HISPANIC", Gender == "MALE") %>% group_by(Child.s.First.Name) %>% summarise(freqM_WNH = sum(Count)) %>% arrange(desc(freqM_WNH)) %>% slice_head(n=10)

ef4_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "WHITE NON HISPANIC", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_WNH = sum(Count)) %>% arrange(desc(freqF_WNH)) %>% slice_head(n=10)

```

```{r}
#| label: fig-genders2
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Bar Graph of the Top 10 Males Names for Asian and Pacific Islander "
#| echo: false


# display in ordered by count
em1_data$Child.s.First.Name <-factor(em1_data$Child.s.First.Name, levels = em1_data$Child.s.First.Name) 

ggplot(data = em1_data, aes(x = Child.s.First.Name, y = freqM_API)) + 
  geom_bar(stat = "identity", fill = 'lightblue') +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  labs(title = "Top 10 Asian and Pacific Islander First Names For Boys",
       x = "Name",
       y = "Count") + 
      theme_minimal()
```

```{r}
#| label: fig-genders3
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Bar Graph of the Top 10 Females Names for Asian and Pacific Islander"
#| echo: false


# display in ordered by count
ef1_data$Child.s.First.Name <-factor(ef1_data$Child.s.First.Name, levels = ef1_data$Child.s.First.Name) 

ggplot(data = ef1_data, aes(x = Child.s.First.Name, y = freqF_API)) + 
  geom_bar(stat = "identity", fill = 'lightpink') +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  labs(title = "Top 10  Asian and Pacific Islander First Names For Girls",
       x = "Name",
       y = "Count") + 
      theme_minimal()
```

```{r}
#| label: fig-genders4
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Bar Graph of the Top 10 Males Names for Black Non-Hispanic "
#| echo: false


# display in ordered by count
em2_data$Child.s.First.Name <-factor(em2_data$Child.s.First.Name, levels = em2_data$Child.s.First.Name) 

ggplot(data = em2_data, aes(x = Child.s.First.Name, y = freqM_BNH)) + 
  geom_bar(stat = "identity", fill = 'lightblue') +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  labs(title = "Top 10 Black non Hispanic First Names For Boys",
       x = "Name",
       y = "Count") + 
      theme_minimal()
```

```{r}
#| label: fig-genders5
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Bar Graph of the Top 10 Females Names for Black Non-Hispanic"
#| echo: false

# display in ordered by count
ef2_data$Child.s.First.Name <-factor(ef2_data$Child.s.First.Name, levels = ef2_data$Child.s.First.Name) 

ggplot(data = ef2_data, aes(x = Child.s.First.Name, y = freqF_BNH)) + 
  geom_bar(stat = "identity", fill = 'lightpink') +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  labs(title = "Top 10 Black non Hispanic First Names For Girls",
       x = "Name",
       y = "Count") + 
      theme_minimal()
```

```{r}
#| label: fig-genders6
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Bar Graph of the Top 10 Males Names for Hispanic"
#| echo: false


# display in ordered by count
em3_data$Child.s.First.Name <-factor(em3_data$Child.s.First.Name, levels = em3_data$Child.s.First.Name) 

ggplot(data = em3_data, aes(x = Child.s.First.Name, y = freqM_H)) + 
  geom_bar(stat = "identity", fill = 'lightblue') +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  labs(title = "Top 10 Hispanic First Names For Boys",
       x = "Name",
       y = "Count") + 
      theme_minimal()
```

```{r}
#| label: fig-genders7
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Bar Graph of the Top 10 Females Names for Hispanic"
#| echo: false


# display in ordered by count
ef3_data$Child.s.First.Name <-factor(ef3_data$Child.s.First.Name, levels = ef3_data$Child.s.First.Name) 

ggplot(data = ef3_data, aes(x = Child.s.First.Name, y = freqF_H)) + 
  geom_bar(stat = "identity", fill = 'lightpink') +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  labs(title = "Top 10 Hispanic First Names For Girls",
       x = "Name",
       y = "Count") + 
      theme_minimal()
```

```{r}
#| label: fig-genders8
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Bar Graph of the Top 10 Males Names for White Non-Hispanic"
#| echo: false

# display in ordered by count
em4_data$Child.s.First.Name <-factor(em4_data$Child.s.First.Name, levels = em4_data$Child.s.First.Name) 

ggplot(data = em4_data, aes(x = Child.s.First.Name, y = freqM_WNH)) + 
  geom_bar(stat = "identity", fill = 'lightblue') +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  labs(title = "Top 10 White Non Hispanic First Names For Boys",
       x = "Name",
       y = "Count") + 
      theme_minimal()
```

```{r}
#| label: fig-genders9
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Bar Graph of the Top 10 Females Names for White Non-Hispanic"
#| echo: false


# display in ordered by count
ef4_data$Child.s.First.Name <-factor(ef4_data$Child.s.First.Name, levels = ef4_data$Child.s.First.Name) 

ggplot(data = ef4_data, aes(x = Child.s.First.Name, y = freqF_WNH)) + 
  geom_bar(stat = "identity", fill = 'lightpink') +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  labs(title = "Top 10 White Non Hispanic First Names For Girls",
       x = "Name",
       y = "Count") + 
      theme_minimal()
```


These charts make it easy to read the names specific to each ethnic group within each gender. However, the question arises: how do we visualize some names shared among different ethnic groups? For instance, are there names shared by both White non-Hispanic (WNH) males and Black non-Hispanic (BNH) males, or by WNH females and BNH females? To address these questions, we merged datasets from two ethnic groups and plotted the results.

```{r merge data sets for all males and females WNH and BNH 10 to 20}
#| echo: false
#| 


library(dplyr)
# develop merge of males between 2 ethnic groups
inner_M1 <- inner_join(em1_data, em3_data, by = "Child.s.First.Name")
inner_M2 <- inner_join(em2_data, em4_data, by = "Child.s.First.Name") 
#inner_M2 # no common result; why? different culture

# expand dataset with top 20 names
em22_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "BLACK NON HISPANIC", Gender == "MALE") %>% group_by(Child.s.First.Name) %>% summarise(freqM_BNH = sum(Count)) %>% arrange(desc(freqM_BNH)) %>% slice_head(n=20)

em44_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "WHITE NON HISPANIC", Gender == "MALE") %>% group_by(Child.s.First.Name) %>% summarise(freqM_WNH = sum(Count)) %>% arrange(desc(freqM_WNH)) %>% slice_head(n=20)


inner_M22 <- inner_join(em22_data, em44_data, by = "Child.s.First.Name")
#inner_M22 # luckily, we get common results but the culture plays an important role in names

####---------------------------------------------------------------------------------------------####

# develop merge of female between 2 ethnic groups
inner_F1 <- inner_join(ef1_data, ef3_data, by = "Child.s.First.Name")
inner_F2 <- inner_join(ef2_data, ef4_data, by = "Child.s.First.Name")
#inner_F2 # only one common names

ef22_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "BLACK NON HISPANIC", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_BNH = sum(Count)) %>% arrange(desc(freqF_BNH)) %>% slice_head(n=20)

ef44_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "WHITE NON HISPANIC", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_WNH = sum(Count)) %>% arrange(desc(freqF_WNH)) %>% slice_head(n=20)

inner_F22 <- inner_join(ef22_data, ef44_data, by = "Child.s.First.Name")
#inner_F22 # Again, cultures difference 

####-----------------------------------------------------------------------####
```

```{r merge data sets for all males and females WNH and BNH 50}
#| echo: false
#| 

# expand dataset with top 50 names
em50_BNH_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "BLACK NON HISPANIC", Gender == "MALE") %>% group_by(Child.s.First.Name) %>% summarise(freqM_BNH = sum(Count)) %>% arrange(desc(freqM_BNH)) %>% slice_head(n=50)

em50_WNP_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "WHITE NON HISPANIC", Gender == "MALE") %>% group_by(Child.s.First.Name) %>% summarise(freqM_WNH = sum(Count)) %>% arrange(desc(freqM_WNH)) %>% slice_head(n=50)


inner_M50 <- inner_join(em50_BNH_data, em50_WNP_data, by = "Child.s.First.Name")
#inner_M50 # more common names but not too much

####---------------------------------------------------------------------------------------------####


ef50_BNH_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "BLACK NON HISPANIC", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_BNH = sum(Count)) %>% arrange(desc(freqF_BNH)) %>% slice_head(n=50)

ef50_WNH_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "WHITE NON HISPANIC", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_WNH = sum(Count)) %>% arrange(desc(freqF_WNH)) %>% slice_head(n=50)

inner_F50 <- inner_join(ef50_BNH_data, ef50_WNH_data, by = "Child.s.First.Name")
#inner_F50 # Again, cultures difference 

####-----------------------------------------------------------------------####
```


After merging the datasets for White non-Hispanic (WNH) and Black non-Hispanic (BNH) to identify the top 10 names among males and females, we found no common names among the males, and only one common name, `Olivia`, among females. Expanding our analysis to the top 20 names, we discovered three common names for boys and four for girls shared across both ethnic groups (Figure 11 and Figure 13). While broadening the range of names revealed more commonalities, the frequency of each name varied significantly between the groups. To show the results, we created side-by-side bar charts showing the frequency of names between WNH and BNH for each gender. Our goal is to convey that different ethnic groups tend to favor different names, and the reason is they have different cultures. The results are displayed in Figure 11 to Figure 13.

```{r}
#| label: fig-ethnic1
#| fig-width: 8
#| fig-height: 4 
#| out-width: 80%  
#| fig-cap: "Side-by-Side Bar Graph of Common Names Among the Top 20 for WNH and BNH Males"
#| echo: false

library(reshape2)
melt_M22 <- melt(inner_M22, id.vars = 'Child.s.First.Name')
melt_M22$variable <- as.character(melt_M22$variable )
melt_M22$variable <- gsub('freqM_BNH', 'Black non-Hispanic - Male', melt_M22$variable)
melt_M22$variable <- gsub('freqM_WNH', 'White non-Hispanic - Male', melt_M22$variable)

ggplot(data = melt_M22, aes(x = Child.s.First.Name, y = value, fill = variable)) + 
  geom_bar(stat = "identity", position = position_dodge()) +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  
  labs(title = "Common Males Frist Name Between Black non-Hispanic and White non-Hispanic",
        subtitle = "within top 20", 
       x = "Name",
       y = "Frequency",
       fill = "Ethnic Group")+
  theme_minimal()

```

```{r}
#| label: fig-ethnic2
#| fig-width: 8
#| fig-height: 4 
#| out-width: 80%  
#| fig-cap: "Side-by-Side Bar Graph of Common Names Among the Top 10 for WNH and BNH Females" 
#| echo: false


melt_F2 <- melt(inner_F2, id.vars = 'Child.s.First.Name')
melt_F2$variable <- as.character(melt_F2$variable )
melt_F2$variable <- gsub('freqF_BNH', 'Black non-Hispanic - Female', melt_F2$variable)
melt_F2$variable <- gsub('freqF_WNH', 'White non-Hispanic - Female', melt_F2$variable)

ggplot(data = melt_F2, aes(x = Child.s.First.Name, y = value, fill = variable)) + 
  geom_bar(stat = "identity", position = position_dodge()) +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  
  labs(title = "Common Females Frist Name Between Black non-Hispanic and White non-Hispanic",
        subtitle = "within top 10", 
       x = "Name",
       y = "Frequency",
       fill = "Ethnic Group")+
  theme_minimal()


#ggplot(melt_F2, aes(x = Child.s.First.Name, y = value, fill = variable)) +
#  geom_bar(stat = "identity") +
#  facet_wrap(~Child.s.First.Name) +
#  labs(title = "Common Females Frist Name Between Black non-Hispanic and White non-Hispanic", 
#       x = "Name", 
#       y = "Frequency")+
#  theme_minimal()


```

```{r}
#| label: fig-ethnic3
#| fig-width: 8
#| fig-height: 4 
#| out-width: 80%  
#| fig-cap: "Side-by-Side Bar Graph of Common Names Among the Top 20 for WNH and BNH Females"
#| echo: false


melt_F22 <- melt(inner_F22, id.vars = 'Child.s.First.Name')
melt_F22$variable <- as.character(melt_F22$variable )
melt_F22$variable <- gsub('freqF_BNH', 'Black non-Hispanic - Female', melt_F22$variable)
melt_F22$variable <- gsub('freqF_WNH', 'White non-Hispanic - Female', melt_F22$variable)

ggplot(data = melt_F22, aes(x = Child.s.First.Name, y = value, fill = variable)) + 
  geom_bar(stat = "identity", position = position_dodge()) +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  
  labs(title = "Common Females Frist Name Between Black non-Hispanic and White non-Hispanic",
        subtitle = "within top 20", 
       x = "Name",
       y = "Frequency",
       fill = "Ethnic Group")+
  theme_minimal()

```

```{r}
#| label: fig-ethnic4
#| fig-width: 8
#| fig-height: 4 
#| out-width: 80%  
#| fig-cap: "Side-by-Side Bar Graph of Common Names Among the Top 10 for API and H Males"
#| echo: false

library(reshape2)
melt_M1 <- melt(inner_M1, id.vars = 'Child.s.First.Name')
melt_M1$variable <- as.character(melt_M1$variable )
melt_M1$variable <- gsub('freqM_API', 'Asian Pacific Islander - Male', melt_M1$variable)
melt_M1$variable <- gsub('freqM_H', 'Hispanic - Male', melt_M1$variable)

ggplot(data = melt_M1, aes(x = Child.s.First.Name, y = value, fill = variable)) + 
  geom_bar(stat = "identity", position = position_dodge()) +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  
  labs(title = "Common Males Frist Name Between Asian Pacific Islander and Hispanic",
        subtitle = "within top 10", 
       x = "Name",
       y = "Frequency",
       fill = "Ethnic Group")+
  theme_minimal()

```

```{r}
#| label: fig-ethnic5
#| fig-width: 8
#| fig-height: 4 
#| out-width: 80%  
#| fig-cap: "Side-by-Side Bar Graph of Common Names Among the Top 10 for API and H Females"
#| echo: false


inner_F1 <- melt(inner_F1, id.vars = 'Child.s.First.Name')
inner_F1$variable <- as.character(inner_F1$variable )
inner_F1$variable <- gsub('freqF_API', 'Asian Pacific Islander - Female', inner_F1$variable)
inner_F1$variable <- gsub('freqF_H', 'Hispanic - Female', inner_F1$variable)

ggplot(data = inner_F1, aes(x = Child.s.First.Name, y = value, fill = variable)) + 
  geom_bar(stat = "identity", position = position_dodge()) +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  
  labs(title = "Common Female Frist Name Between Asian Pacific Islander and Hispanic",
        subtitle = "within top 10", 
       x = "Name",
       y = "Frequency",
       fill = "Ethnic Group") +
  theme_minimal()
```


Comparing the frequency of each name within each ethnic group might not be the best approach, as it could lead to fallacious conclusions. This method fails to account for the varying sizes of each ethnic group. A more effective comparison would involve using the proportion of each name within each ethnic group. By comparing these proportions, we can more accurately assess the popularity of names. In this analysis, we have displayed the proportions of the name 'Olivia' in both Black non-Hispanic and White non-Hispanic groups. Interestingly, it appears that the Black non-Hispanic group has a stronger preference for this name.


```{r calculate ratio of Olivia in each ethnic group}
#| echo: false
#| 

total_ef2 <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "BLACK NON HISPANIC", Gender == "FEMALE") %>% summarise(total_BNH = sum(Count))

total_count <- total_ef2$total_BNH

freq_ef2 <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "BLACK NON HISPANIC", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_BNH = sum(Count)) %>% ungroup()

prop_ef2 <- freq_ef2 %>% mutate(prop_F_BNH = freqF_BNH / total_count) %>% filter(Child.s.First.Name == 'olivia')
##-------------------------------------------------------------###

total_ef4 <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "WHITE NON HISPANIC", Gender == "FEMALE") %>% summarise(total_WNH = sum(Count))

total_count4 <- total_ef4$total_WNH

freq_ef4 <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "WHITE NON HISPANIC", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_WNH = sum(Count)) %>% ungroup()

prop_ef4 <- freq_ef4 %>% mutate(prop_F_WNH = freqF_WNH / total_count4) %>% filter(Child.s.First.Name == 'olivia')

propData_ef2 <- data.frame(prop_ef2$Child.s.First.Name, prop_ef2$prop_F_BNH , prop_ef4$prop_F_WNH)
colnames(propData_ef2) <- c("Child_Name", "Black non-Hispanic - Female", "White non-Hispanic - Female")

```



```{r}
#| label: fig-prop1
#| fig-width: 8
#| fig-height: 4 
#| out-width: 80%  
#| fig-cap: "Side-by-Side Bar Graph of Proportional Comparison -BNH vs. WNH " 
#| echo: false


melt_prop2 <- melt(propData_ef2, id.vars = 'Child_Name')
melt_prop2$variable <- as.character(melt_prop2$variable )


ggplot(data = melt_prop2, aes(x = Child_Name, y = value, fill = variable)) + 
  geom_bar(stat = "identity", position = position_dodge()) +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  
  labs(title = "Proportion of Olivia Between Black non-Hispanic and White non-Hispanic",
       x = "Name",
       y = "Proportion",
       fill = "Ethnic Group")+
  theme_minimal()

#ggplot(melt_prop2, aes(x = Child_Name, y = value, fill = variable)) +
#  geom_bar(stat = "identity") +
#  facet_wrap(~Child_Name) +
#  labs(title = "Proportion of Olivia Between Black non-Hispanic and White non-Hispanic", 
#       x = "Name", 
#       y = "Proportion")+
#  theme_minimal()

```


```{r calculate ratio of commonlarity in WNH vs BNH for females}
#| echo: false
#| 


#total_ef2 <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "BLACK NON HISPANIC", Gender == "FEMALE") %>% summarise(total_BNH = sum(Count))

#total_count <- total_ef2$total_BNH

#freq_ef2 <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "BLACK NON HISPANIC", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_BNH = sum(Count)) %>% ungroup()

prop_ef22 <- freq_ef2 %>%
  mutate(prop_F_BNH = freqF_BNH / total_count) %>%
  filter(Child.s.First.Name %in% c('olivia', 'ava', 'isabella', 'mia'))

##-------------------------------------------------------------###

#total_ef4 <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "WHITE NON HISPANIC", Gender == "FEMALE") %>% summarise(total_WNH = sum(Count))

#total_count4 <- total_ef4$total_WNH

#freq_ef4 <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "WHITE NON HISPANIC", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_WNH = sum(Count)) %>% ungroup()

prop_ef44 <- freq_ef4 %>% 
  mutate(prop_F_WNH = freqF_WNH / total_count4) %>% 
  filter(Child.s.First.Name %in% c('olivia', 'ava', 'isabella', 'mia'))

propData_ef22 <- data.frame(prop_ef22$Child.s.First.Name, prop_ef2$prop_F_BNH , prop_ef4$prop_F_WNH)
colnames(propData_ef22) <- c("Child_Name", "Black non-Hispanic - Female", "White non-Hispanic - Female")

```



We also extract the top 20 common names shared between BNH and WNH and calculate their proportions, which are then plotted in the figure below. These names are used by both ethnic groups, but WNH shows a higher preference for them than BNH. 


```{r}
#| label: fig-ethnic31
#| fig-width: 8
#| fig-height: 4 
#| out-width: 80%  
#| fig-cap: "Side-by-Side Bar Graph of Proportional Comparison -BNH vs. WNH Females"
#| echo: false


melt_prop22 <- melt(propData_ef22, id.vars = 'Child_Name')
melt_prop22$variable <- as.character(melt_prop22$variable )

ggplot(data = melt_prop22, aes(x = Child_Name, y = value, fill = variable)) + 
  geom_bar(stat = "identity", position = position_dodge()) +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  
  labs(title = "Proportion of Female Names Between Black non-Hispanic and White non-Hispanic",
       subtitle = "within top 20", 
       x = "Name",
       y = "Proportion",
       fill = "Ethnic Group")+
  theme_minimal()

```


```{r calculate ratio of commonlarity in WNH vs BNH for males}
#| echo: false
#| 



total_em2 <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "BLACK NON HISPANIC", Gender == "MALE") %>% summarise(total_BNH = sum(Count))

total_count_em2 <- total_em2$total_BNH

freq_em2 <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "BLACK NON HISPANIC", Gender == "MALE") %>% group_by(Child.s.First.Name) %>% summarise(freqM_BNH = sum(Count)) %>% ungroup()

prop_em2 <- freq_em2 %>% mutate(prop_M_BNH = freqM_BNH / total_count) %>% 
  select(Child.s.First.Name, prop_M_BNH) %>%  arrange(desc(prop_M_BNH))


##-------------------------------------------------------------###

total_em4 <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "WHITE NON HISPANIC", Gender == "MALE") %>% summarise(total_WNH = sum(Count))

total_count_em4 <- total_em4$total_WNH

freq_em4 <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "WHITE NON HISPANIC", Gender == "MALE") %>% group_by(Child.s.First.Name) %>% summarise(freqM_WNH = sum(Count)) %>% ungroup()

prop_em4 <- freq_em4 %>% mutate(prop_M_WNH = freqM_WNH / total_count4) %>% 
  select(Child.s.First.Name, prop_M_WNH) %>% arrange(desc(prop_M_WNH))



##-------------------------------------------------------------###

inner_em4 <- inner_join(prop_em2, prop_em4, by = "Child.s.First.Name") %>% 
  filter(Child.s.First.Name %in%  c('david', 'jacob', 'michael', 'noah'))

colnames(inner_em4) <- c("Child_Name", "Black non-Hispanic - Male", "White non-Hispanic - Male")

```


```{r}
#| label: fig-ethnic31
#| fig-width: 8
#| fig-height: 4 
#| out-width: 80%  
#| fig-cap: "Side-by-Side Bar Graph of Proportional Comparison -BNH vs. WNH Males"
#| echo: false


melt_prop4 <- melt(inner_em4, id.vars = 'Child_Name')
melt_prop4$variable <- as.character(melt_prop4$variable )

ggplot(data = melt_prop4, aes(x = Child_Name, y = value, fill = variable)) + 
  geom_bar(stat = "identity", position = position_dodge()) +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  
  labs(title = "Proportion of Males Names Between Black non-Hispanic and White non-Hispanic",
       subtitle = "within top 20", 
       x = "Name",
       y = "Proportion",
       fill = "Ethnic Group")+
  theme_minimal()

```


BNH prefers 'Noah' over WNH for naming a male baby. In the Bible, Noah was an important figure who built the Ark, saving his family and every species of animal. People from these two communities favor this name due to this religious reason (Source:[Noah](https://thebump.com/b/noah-baby-name)). Meanwhile, the other three names, David, Jacob, and Michael, are very popular, and some of your friends may likely be named one of them. 


When investigating common names across different ethnic groups, we also explored the presence of unisex names – those used for both males and females. The findings regarding these unisex names are presented in Figure 16.

```{r Develop Unisex Name: merge males and females within the same ethnic groups}
#| echo: false

## Develop Unisex Name: merge males and females within the same ethnic groups 
em1_100_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "ASIAN AND PACIFIC ISLANDER" & Gender == "MALE") %>% group_by(Child.s.First.Name) %>% summarise(freqM_API = sum(Count), .groups = "drop") %>% arrange(desc(freqM_API)) %>% head(n=1000)

ef1_100_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "ASIAN AND PACIFIC ISLANDER", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_API = sum(Count)) %>% arrange(desc(freqF_API)) %>% slice_head(n=1000)

inner_com1 <- inner_join(em1_100_data, ef1_100_data, by = "Child.s.First.Name")
# found 4 unisex names


em2_100_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "BLACK NON HISPANIC", Gender == "MALE") %>% group_by(Child.s.First.Name) %>% summarise(freqM_BNH = sum(Count)) %>% arrange(desc(freqM_BNH)) %>% slice_head(n=1000)

ef2_100_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "BLACK NON HISPANIC", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_BNH = sum(Count)) %>% arrange(desc(freqF_BNH)) %>% slice_head(n=1000)

inner_com2 <- inner_join(em2_100_data, ef2_100_data, by = "Child.s.First.Name")
# no result

### selected 1000 to see whether there is unisex name; check M_data2 to each # of each gender or ethnic group
em3_100_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "HISPANIC", Gender == "MALE") %>% group_by(Child.s.First.Name) %>% summarise(freqM_H = sum(Count)) %>% arrange(desc(freqM_H)) %>% slice_head(n=1000)

ef3_100_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "HISPANIC", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_H = sum(Count)) %>% arrange(desc(freqF_H)) %>% slice_head(n=1000)

inner_com3 <- inner_join(em3_100_data, ef3_100_data, by = "Child.s.First.Name")


em4_100_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "WHITE NON HISPANIC", Gender == "MALE") %>% group_by(Child.s.First.Name) %>% summarise(freqM_WNH = sum(Count)) %>% arrange(desc(freqM_WNH)) %>% slice_head(n=1000)

ef4_100_data <- modified_data %>% select('Ethnicity', 'Gender' , 'Child.s.First.Name', 'Count') %>% filter(Ethnicity == "WHITE NON HISPANIC", Gender == "FEMALE") %>% group_by(Child.s.First.Name) %>% summarise(freqF_WNH = sum(Count)) %>% arrange(desc(freqF_WNH)) %>% slice_head(n=1000)

inner_com4 <- inner_join(em4_100_data, ef4_100_data, by = "Child.s.First.Name")

# Females Names
VF_data <- modified_data %>% 
  filter(Gender == "FEMALE") %>% 
  group_by(Child.s.First.Name, Gender) %>% 
  summarise(freq = sum (Count),  .groups = "drop") %>% 
  arrange(desc(freq))

# Males Names
VM_data <- modified_data %>% 
  filter(Gender == "MALE") %>% 
  group_by(Child.s.First.Name, Gender) %>%
  summarise(freq = sum(Count), .groups = "drop") %>% 
  arrange(desc(freq))

inner_COM <- inner_join(VF_data, VM_data, by = "Child.s.First.Name") %>% head(10)

###----------------------------------------------------------------------###

library(tidyr)
df_long <- pivot_longer(inner_COM, 
                        cols = c(freq.x, freq.y), 
                        names_to = "Gender", 
                        values_to = "Frequency",
                        names_prefix = "freq.")
df_long$Gender <- recode(df_long$Gender, 'x' = 'FEMALE', 'y' = 'MALE')
```

```{r unisex name by year}
#| echo: false

## the result is less meaningful since did not see an increasing trend of unisex names over time 
M_2011 <- modified_data %>% filter(Year.of.Birth %in% 2011 & Gender == 'MALE') %>% select('Child.s.First.Name')
F_2011 <- modified_data %>% filter(Year.of.Birth %in% 2011 & Gender == 'FEMALE') %>% select('Child.s.First.Name')
inner_2011 <- inner_join(M_2011, F_2011, by = "Child.s.First.Name")
inner_2011_count <- inner_2011 %>% count('Child.s.First.Name')

M_2012 <- modified_data %>% filter(Year.of.Birth %in% 2012 & Gender == 'MALE') %>% select('Child.s.First.Name')
F_2012 <- modified_data %>% filter(Year.of.Birth %in% 2012 & Gender == 'FEMALE') %>% select('Child.s.First.Name')
inner_2012 <- inner_join(M_2012, F_2012, by = "Child.s.First.Name")
inner_2012_count <- inner_2012 %>% count('Child.s.First.Name')

M_2018 <- modified_data %>% filter(Year.of.Birth %in% 2018 & Gender == 'MALE') %>% select('Child.s.First.Name')
F_2018 <- modified_data %>% filter(Year.of.Birth %in% 2018 & Gender == 'FEMALE') %>% select('Child.s.First.Name')
inner_2018 <- inner_join(M_2018, F_2018, by = "Child.s.First.Name")
inner_2018_count <- inner_2018 %>% count('Child.s.First.Name')

M_2019 <- modified_data %>% filter(Year.of.Birth %in% 2019 & Gender == 'MALE') %>% select('Child.s.First.Name')
F_2019 <- modified_data %>% filter(Year.of.Birth %in% 2019 & Gender == 'FEMALE') %>% select('Child.s.First.Name')
inner_2019 <- inner_join(M_2019, F_2019, by = "Child.s.First.Name")
inner_2019_count <- inner_2019 %>% count('Child.s.First.Name')

## write a function to plot the sum of unisex names from 2011 to 2019
#unisex_name_by_year <- function(year, gender) {
#  M_year <- modified_data %>% filter(Year.of.Birth %in% year & Gender == 'gender') %>% select('Child.s.First.Name')
#  F_year <- modified_data %>% modified_data %>% filter(Year.of.Birth %in% year & Gender == 'gender') %>% select('Child.s.First.Name')
#  countnumber <- inner_join(M_year, F_year, by = "Child.s.First.Name") %>% count('Child.s.First.Name')
#}

#unisex_name_by_year(2011, 'MALE')

```

```{r}
#| label: fig-combined
#| fig-width: 8
#| fig-height: 4 
#| out-width: 80%  
#| fig-cap: "Side-by-Side Bar Graph of Unisex Names"
#| echo: false




ggplot(data = df_long, aes(x = Child.s.First.Name, y = Frequency, fill = Gender)) + 
  geom_bar(stat = "identity", position = position_dodge()) +  
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +  
  labs(title = "Unisex Names Frenquency by Gender",
       x = "Name",
       y = "Frequency",
       fill = "Gender")+
  theme_minimal()
```

In Figure 16, we were surprised to find that 'Dylan', a name meaning 'son of the sea,' is popular for both males and females. Its poetic and windswept connotations may contribute to its appeal, especially for girls (Source: [Dylan](https://nameberry.com/babyname/dylan/girl)). Additionally, 'Avery,' originally a boy's name meaning 'ruler of the elves' in English, has become more commonly used for girls (Source: [Avery](https://nameberry.com/babyname/avery/girl)). We also observed that 'Tenzin' is exclusively used in Asian and Pacific Islander (API) communities for both genders. The name, which means 'Holder of the teaching,' reflects a strong religious influence within API communities (Source: [Tenzin](https://nameberry.com/babyname/tenzin/girl)). Overall, the choice of unisex names is primarily influenced by their meanings, but religious and cultural factors also play a crucial role.



Next, we developed time plots to display the average length of names for each gender and ethnic group, which are presented in Figures 17 and 18.

```{r calculate average length of letters for names}
#| echo: false

library(stringr)
# calculate the length of letter of each name
length_data <- modified_data %>% mutate(N.Length = str_count(Child.s.First.Name, "[A-Za-z]")) %>% mutate(T.length = Count * N.Length) 
# calculate the average number of letters in each year for males and females
avglength_data <- length_data  %>% group_by(Year.of.Birth, Gender) %>% 
  summarise(Avg.Letters = mean(N.Length, na.rm = TRUE), .groups = "drop") %>% 
  arrange(Year.of.Birth, Gender)
# calculate the average number of letters in each year for each ethnic groups
avglength_data_ethnic <- length_data  %>% group_by(Year.of.Birth, Ethnicity) %>% 
  summarise(Avg.Letters = mean(N.Length, na.rm = TRUE), .groups = "drop") %>% 
  arrange(Year.of.Birth, Ethnicity)

```

```{r}
#| label: fig-AverageLength1
#| fig-width: 8
#| fig-height: 4 
#| out-width: 80%  
#| fig-cap: "Average Length of First Names for Males and Females"
#| echo: false


ggplot(data = avglength_data, aes(x = Year.of.Birth, y = Avg.Letters, color = Gender, group = Gender)) + 
  geom_line() +
  geom_point() +
  scale_x_continuous(breaks = seq(2011, 2019, by=1), limits = c(2011, 2019)) +
  labs(title = "Average Number of Letters in Babies' Name by Gender", 
       subtitle = "from 2011 to 2019", 
       x = "Year", 
       y = "Average Number of Letters") + 
    theme_minimal()
```

```{r}
#| label: fig-AverageLength2
#| fig-width: 8
#| fig-height: 4 
#| out-width: 80%  
#| fig-cap: "Average Length of First Names for Different Ethnic Groups"
#| echo: false


ggplot(data = avglength_data_ethnic, aes(x = Year.of.Birth, y = Avg.Letters, color = Ethnicity, group = Ethnicity)) + 
  geom_line() +
  geom_point() +
  scale_x_continuous(breaks = seq(2011, 2019, by=1), limits = c(2011, 2019)) +
  labs(title = "Average Number of Letters in Babies' Name by Ethnicity", 
       subtitle = "from 2011 to 2019", 
       x = "Year", 
       y = "Average Number of Letters") + 
    theme_minimal()
```

The time plot reveals the average length of names has generally decreased over time. The primary reason for this trend is a growing preference for shorter names. This trend appears to be driven by a growing preference for shorter names. Many people today prefer short names because they are easier to remember and can often be more distinctive. There are other factors influenced the popularity of short names. For instance, Katie, in her article 'Study: Short Names Are Long on Earning Power,' states that shorter names are often associated with higher salaries, highlighting another potential reason for their increasing popularity. (Source:[Popularity](https://daily.jstor.org/science-baby-names/) [Shorter Name Higher Salary](https://associationsnow.com/2013/05/study-short-names-are-long-on-earning-power/) [Study Says Shorter Names Earn More](https://www.forbes.com/sites/laurashin/2013/05/07/study-says-shorter-names-earn-more/?sh=443c788972ea))


Here we are trying to understand the variation of the most popular baby names from 2011-2019. A line plot is used to analyze this and clearly see the trend over the years.

```{r}
top10_names <- modified_data %>% filter(Rank %in% c(1:10))
```

```{r }
#| label: fig-PopularNamesM1
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Most popular names for Male Hispanics"
#| echo: false



df1 <- top10_names %>% filter(Ethnicity == "HISPANIC" & Gender == "MALE") %>% arrange(Rank) %>% head(9)


ggplot(df1, aes(x = Year.of.Birth, y = Count )) +
  geom_line(color = "red", linetype = "solid", size = 1.25) +
  geom_label(aes(label = c(Child.s.First.Name)), nudge_x = 0.25, nudge_y = 0.25, color = "blue", size = 4) +
  geom_text(aes(label = c(Count)), nudge_x = 0.25, nudge_y = 5, color = "black", size = 3.5) +
  scale_x_discrete(limits = c(2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,2019)) +
  labs(title = "Most popular names for Male Hispanics ", subtitle = "(2011 - 2019)", x = "Birth Year", y = "Frequency")
```

```{r}
#| label: fig-PopularNamesM2
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Most popular names for Male White Non-Hispanics"
#| echo: false

df1 <- top10_names %>% filter(Ethnicity == "WHITE NON HISPANIC"  & Gender == "MALE") %>% arrange(Rank) %>% head(9)

ggplot(df1, aes(x = Year.of.Birth, y = Count )) +
  geom_line(color = "red", linetype = "solid", size = 1.25) +
  geom_label(aes(label = c(Child.s.First.Name)), nudge_x = 0.25, nudge_y = 0.25, color = "blue", size = 4) +
  geom_text(aes(label = c(Count)), nudge_x = 0.25, nudge_y = 5, color = "black", size = 3.5) +
  scale_x_discrete(limits = c(2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,2019)) +
  labs(title = "Most popular names for Male White Non-Hispanics ", subtitle = "(2011 - 2019)", x = "Birth Year", y = "Frequency")
```

```{r}
#| label: fig-PopularNamesM3
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Most popular names for  Male Asian Pacific Islanders"
#| echo: false


df1 <- top10_names %>% filter(Ethnicity == "ASIAN AND PACIFIC ISLANDER"  & Gender == "MALE") %>% arrange(Rank) %>% head(9)

ggplot(df1, aes(x = Year.of.Birth, y = Count )) +
  geom_line(color = "red", linetype = "solid", size = 1.25) +
  geom_label(aes(label = c(Child.s.First.Name)), nudge_x = 0.25, nudge_y = 0.25, color = "blue", size = 4) +
  geom_text(aes(label = c(Count)), nudge_x = 0.25, nudge_y = 5, color = "black", size = 3.5) +
  scale_x_discrete(limits = c(2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,2019)) +
  labs(title = "Most popular names for  Male Asian Pacific Islanders", subtitle = "(2011 - 2019)", x = "Birth Year", y = "Frequency")   
```

```{r}
#| label: fig-PopularNamesM4
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Most popular names for Male Black Non-Hispanic"
#| echo: false

df1 <- top10_names %>% filter(Ethnicity == "BLACK NON HISPANIC"  & Gender == "MALE") %>% arrange(Rank) %>% head(9)

ggplot(df1, aes(x = Year.of.Birth, y = Count )) +
  geom_line(color = "red", linetype = "solid", size = 1.25) +
  geom_label(aes(label = c(Child.s.First.Name)), nudge_x = 0.25, nudge_y = 0.25, color = "blue", size = 4) +
  geom_text(aes(label = c(Count)), nudge_x = 0.25, nudge_y = 5, color = "black", size = 3.5) +
  scale_x_discrete(limits = c(2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,2019)) +
  labs(title = "Most popular names for Male Black Non-Hispanics", subtitle = "(2011 - 2019)", x = "Birth Year", y = "Frequency") 
```

```{r}
#| label: fig-PopularNamesF1
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Most popular name for female Hispanics "
#| echo: false

df1 <- top10_names %>% filter(Ethnicity == "HISPANIC" & Gender == "FEMALE") %>% arrange(Rank) %>% head(9)


ggplot(df1, aes(x = Year.of.Birth, y = Count )) +
  geom_line(color = "red", linetype = "solid", size = 1.25) +
  geom_label(aes(label = c(Child.s.First.Name)), nudge_x = 0.25, nudge_y = 0.25, color = "blue", size = 4) +
  geom_text(aes(label = c(Count)), nudge_x = 0.25, nudge_y = 5, color = "black", size = 3.5) +
  scale_x_discrete(limits = c(2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,2019)) +
  labs(title = "Most popular name for female Hispanics ", subtitle = "(2011 - 2019)", x = "Birth Year", y = "Frequency")

```

```{r}
#| label: fig-PopularNamesF2
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Most popular name for female White Non-Hispanics  "
#| echo: false

df1 <- top10_names %>% filter(Ethnicity == "WHITE NON HISPANIC"  & Gender == "FEMALE") %>% arrange(Rank) %>% head(9)

ggplot(df1, aes(x = Year.of.Birth, y = Count )) +
  geom_line(color = "red", linetype = "solid", size = 1.25) +
  geom_label(aes(label = c(Child.s.First.Name)), nudge_x = 0.25, nudge_y = 0.25, color = "blue", size = 4) +
  geom_text(aes(label = c(Count)), nudge_x = 0.25, nudge_y = 5, color = "black", size = 3.5) +
  scale_x_discrete(limits = c(2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,2019)) +
  labs(title = "Most popular name for female White Non-Hispanics ", subtitle = "(2011 - 2019)", x = "Birth Year", y = "Frequency")
```

```{r}
#| label: fig-PopularNamesF3
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Most popular name for  female Asian Pacific Islanders"
#| echo: false

df1 <- top10_names %>% filter(Ethnicity == "ASIAN AND PACIFIC ISLANDER"  & Gender == "FEMALE") %>% arrange(Rank) %>% head(9)

ggplot(df1, aes(x = Year.of.Birth, y = Count )) +
  geom_line(color = "red", linetype = "solid", size = 1.25) +
  geom_label(aes(label = c(Child.s.First.Name)), nudge_x = 0.25, nudge_y = 0.25, color = "blue", size = 4) +
  geom_text(aes(label = c(Count)), nudge_x = 0.25, nudge_y = 5, color = "black", size = 3.5) +
  scale_x_discrete(limits = c(2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,2019)) +
  labs(title = "Most popular name for  female Asian Pacific Islanders", subtitle = "(2011 - 2019)", x = "Birth Year", y = "Frequency")   

```

```{r}
#| label: fig-PopularNamesF4
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Most popular name for female Black Non-Hispanics"
#| echo: false

df1 <- top10_names %>% filter(Ethnicity == "BLACK NON HISPANIC"  & Gender == "FEMALE") %>% arrange(Rank) %>% head(9)

ggplot(df1, aes(x = Year.of.Birth, y = Count )) +
  geom_line(color = "red", linetype = "solid", size = 1.25) +
  geom_label(aes(label = c(Child.s.First.Name)), nudge_x = 0.25, nudge_y = 0.25, color = "blue", size = 4) +
  geom_text(aes(label = c(Count)), nudge_x = 0.25, nudge_y = 5, color = "black", size = 3.5) +
  scale_x_discrete(limits = c(2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,2019)) +
  labs(title = "Most popular name for female Black Non-Hispanics", subtitle = "(2011 - 2019)", x = "Birth Year", y = "Frequency") 
```

```{r}
#| label: fig-PopularNamesE1
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Most popular names for Males by Ethnicity"
#| echo: false

df1 <- top10_names %>% filter(Gender == "MALE", Rank == 1) 

ggplot(df1, aes(x = Year.of.Birth, y = Count, color = Ethnicity, fill = Ethnicity )) +
  geom_line(linetype = "solid", size = 1.5) +
  geom_label(aes(label = c(Child.s.First.Name)), nudge_x = 0.25, nudge_y = 0.15, color = "blue", size = 3) +
  guides(fill = guide_legend(override.aes = aes(color = NA))) +
  scale_x_discrete(limits = c(2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,2019)) +
  scale_y_continuous(breaks = seq(100, 450, by=50))+
  labs(title = "Most popular names for males by Ethnicity", subtitle = "(2011 - 2019)", x = "Birth Year", y = "Frequency") 

 
```

```{r}
#| label: fig-PopularNamesE2
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Most popular names for females by Ethnicity"
#| echo: false

df1 <- top10_names %>% filter(Gender == "FEMALE", Rank == 1) 

ggplot(df1, aes(x = Year.of.Birth, y = Count, fill = Ethnicity, color = Ethnicity )) +
  geom_line(linetype = "solid", size = 1.5) +
  geom_label(aes(label = c(Child.s.First.Name)), nudge_x = 0.25, nudge_y = 0.15, color = "blue", size = 3) +
  guides(fill = guide_legend(override.aes = aes(color = NA))) +
  scale_x_discrete(limits = c(2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,2019)) +
  scale_y_continuous(breaks = seq(100, 450, by=50))+
  labs(title = "Most popular names for females by Ethnicity", subtitle = "(2011 - 2019)", x = "Birth Year", y = "Frequency")
```


Through these plots, we visualize the dynamic trends in name popularity, revealing notable spikes or dips in specific years. The plots illustrate whether certain names experience rapid surges or declines in favor and whether there are enduring or shifting preferences across different ethnic groups. Additionally, they showcase the evolving patterns in name selection, providing a comprehensive view of how naming preferences evolve over time.


```{r}
#A function to find the most popular names of MALES and FEMALE (Not considering the ethnicity) 

#Note: Planning on trying to improve this function.
find_popular_names <- function() {
  
df1 <- top10_names %>% filter(Rank == 1, Gender == "MALE" ) %>% 
group_by(Year.of.Birth,Gender,Child.s.First.Name) %>% 
summarise(freq = sum(Count), .groups = "drop")

df <- data.frame("Child.s.First.Name" = character(0), "freq"  = numeric(0))
years <- unique(df1$Year.of.Birth)
  
for (i in 1:length(years)) {
  df0 <- df1 %>% filter(Year.of.Birth == years[i])
    
  row <- df0[df0$freq == max(df0$freq), ]
    
  df <- rbind(df, row)
    
}
  

df1 <- top10_names %>% filter(Rank == 1, Gender == "FEMALE" ) %>% 
group_by(Year.of.Birth,Gender,Child.s.First.Name) %>% 
  summarise(freq = sum(Count), .groups = "drop")

for (i in 1:length(years)) {
  df0 <- df1 %>% filter(Year.of.Birth == years[i])
    
  row <- df0[df0$freq == max(df0$freq), ]
    
  df <- rbind(df, row)
    
  }

return(df)
  
}

df <- find_popular_names()






```

```{r, warning=FALSE}
#| label: fig-PopularNames
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Most popular names for each Gender (Regardless of ethnicity)"
#| echo: false


ggplot(df, aes(x = Year.of.Birth, y = freq, fill=Gender, color = Gender)) +
  geom_line(linetype = "solid", size = 1.5) +
   scale_x_discrete(limits = c(2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,2019))+
  geom_label(aes(label = c(Child.s.First.Name)), nudge_x = 0.25, nudge_y = 0.15, color = "blue", size = 3) +
  guides(fill = guide_legend(override.aes = aes(color = NA))) +

  scale_y_continuous(breaks = seq(100, 650, by=50))+
  labs(title = "Most popular names for each Gender", subtitle = "(2011 - 2019)", x = "Birth Year", y = "Frequency") 
```

The names **Jayden** and **Liam** held the top positions as the most popular choices for baby boys across diverse ethnicities from 2011 to 2019. Meanwhile, **Isabella**, **Olivia** , and **Esther** emerged as the favored names for baby girls during the same period. This trend persisted regardless of cultural backgrounds.

A search engine query for the most popular baby names in the United States consistently showcased **Liam** as the leading choice for boys and **Olivia** as the foremost pick for girls. Our analysis aligns with these findings, reflecting a parallel preference for these names across the nation.

```{r}
#| label: fig-Rank_Count
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Relationship between the Rank and the Count variable"
#| echo: false



ggplot(modified_data, aes(x = Rank, y = Count)) +
  geom_point(color = "lightblue") +
  labs(title = "Rank vs the Count",
       subtitle = "Are names with higher frequency always rank higer?",
       x = "Ranks",
       y = "Count") +
  geom_smooth(method = "lm", se = FALSE, color = "blue") +
  scale_x_discrete(limits = c(1:102), breaks = seq(1,105, by = 10))


```

The scatter plot for Rank vs Count variable was drawn as a part of the analysis of the rank variable and is helpful to get an understanding of the behavior of the two variable respect to each other. And as the plot suggests the higher rank is given to names with a higher frequency.

```{r}
#| label: fig-Rank
#| fig-width: 8
#| fig-height: 4 # Change the figure dimensions using fig-width/height
#| out-width: 80% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Distribution of the rank variable"
#| echo: false

ggplot(modified_data, aes(x = Rank)) +
  geom_histogram(binwidth = 5, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Rank Variable",
       x = "Rank Variable",
       y = "Frequency")
```

This plot shows the distribution of the rank variable. And as the plot suggest there are multiple names with the same rank that has similar frequencies.

Creating a word cloud for the popular baby names

```{r word cloud}
#| label: fig-wordcloudM
#| fig-width: 8
#| fig-height: 5 # Change the figure dimensions using fig-width/height
#| out-width: 100% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Word cloud for the most popolar baby names for males"
#| echo: false

modified_data %>% 
  filter(Gender == "MALE" & Rank %in% c(1:100)) %>% 
  group_by(Child.s.First.Name) %>% 
  summarise(freq = sum(Count)) %>% arrange(desc(freq)) %>% 
  head(100) %>% 
  with(wordcloud(Child.s.First.Name, freq, max.words = 100, 
                 scale = c(2, 0.5), 
                 colors = brewer.pal(8, "Dark2")))
title(main = "Most popolar baby names for males")
```

```{r}
#| label: fig-wordcloudF
#| fig-width: 8
#| fig-height: 5 # Change the figure dimensions using fig-width/height
#| out-width: 100% # This changes the size of the figure as rendered in the text. 
#| fig-cap: "Word cloud for the most popolar baby names for females"
#| echo: false


modified_data %>% 
  filter(Gender == "FEMALE" & Rank %in% c(1:100)) %>% 
  group_by(Child.s.First.Name) %>% 
  summarise(freq = sum(Count)) %>% arrange(desc(freq)) %>% 
  head(100) %>% 
  with(wordcloud(Child.s.First.Name, freq, max.words = 100, 
                 scale = c(2, 0.5), 
                 colors = brewer.pal(8, "Dark2")))
title(main = "Most popolar baby names for females")
```

A word cloud is a visual representation of text data. Typically, the more frequently a word appears in the source material, the larger and more prominently it is displayed in the word cloud. The aim of having a word cloud is that, it provides a quick an an intuitive way to comprehend the most prevalent names.
The word clouds displaying popular names for boys and girls highlight a clear trend: a small group of names appears frequently, while many others show up less often. This suggests that a handful of names are super popular, while the rest are not as commonly used in the dataset.

## Additional Exploration topic

From the time plot of the average name lengths, we observe that the mean length for male names is shorter than that for female names. Could this be due to males seeking more unique names? Additionally, the time plot for different ethnic groups shows that the average name length for Asians and Pacific Islanders is the shortest among the groups. This could be due to cultural factors. We might need to review additional articles to understand the background of Asian and Pacific Islander naming practices and investigate the differences between male and female names.


## Conclusion

Different ethnic groups, particularly White Non-Hispanic and Black Non-Hispanic, use different baby names, and it reflects diverse cultures. Currently, unisex names appear to be a trend, indicating that parents are prioritizing the meanings of names and moving away from traditional naming conventions. Additionally, there has been a noticeable decrease in the average length of names over time, with a growing preference for shorter names. In the time plot, the average length of names for females decreased from 5.925 to 5.725, and for males, it decreased from 5.75 to 5.65. In another time plot, which focused on ethnic groups, all groups exhibited a decreasing trend in the average length of names from 2011 to 2019. This trend might be influenced by the notion, as highlighted in an article, that 'a shorter name could lead to more financial success.' Such a belief could lead parents to choose shorter names and they hope their children will achieve greater success.

Across diverse ethnicities from 2011 to 2019, the names `Jayden` and `Liam` were widely favored for baby boys, while `Isabella`, `Olivia`, and `Esther` were popular choices for baby girls. This trend remained consistent regardless of cultural backgrounds. A consistent trend observed through search engine queries on popular baby names in the United States reaffirmed Liam's prominence among boys and Olivia's popularity among girls. Our analysis concurs with these findings, highlighting a consistent national preference for these particular names.
